(function(e){function t(t){for(var r,a,s=t[0],c=t[1],l=t[2],d=0,p=[];d<s.length;d++)a=s[d],i[a]&&p.push(i[a][0]),i[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(p.length)p.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(r=!1)}r&&(o.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},i={app:0},o=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/whiteboard/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"06dc":function(e,t,n){},"13d6":function(e,t,n){},1449:function(e,t,n){"use strict";n.r(t);n("c5f6");var r=n("795b"),i=n.n(r),o=(n("96cf"),n("3b8d"));window.delay=function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new i.a(function(e){return setTimeout(e,t)}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Number.prototype.round=function(e){var t=window.Math.pow(10,e);return window.Math.round(this*t)/t}},"3a61":function(e,t,n){"use strict";var r=n("cb1b"),i=n.n(r);i.a},"56d7":function(e,t,n){"use strict";n.r(t);n("96cf");var r,i=n("3b8d");n("cadf"),n("551c"),n("f751"),n("097d");r={socket:{url:"https://diliviri.com/",namespace:"superadmin"},http:{main:"db/"}};var o=r,a=(n("ab8b"),n("87b8"),n("9180"),n("2b0e")),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("transition-group",{attrs:{name:"opacity"}},[n("whiteboard",{key:"1",style:e.showpopup?"filter:blur(4px)":"",on:{clear:e.clearDrawing,draw:e.sendDrawing,"show-group":function(t){e.showpopup=!0}}}),e.showpopup?n("popup",{key:"2",on:{dismiss:function(t){e.showpopup=!1}}}):e._e()],1)},c=[],l=(n("7f7f"),n("f499")),u=n.n(l),d=n("5d73"),p=n.n(d),h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"container",staticStyle:{position:"relative",width:"100%",height:"100%","background-color":"white",overflow:"hidden"}},[n("div",{staticClass:"canvascontainer",staticStyle:{position:"relative",width:"vw",height:"vh","background-color":"white"}},[n("canvas",{ref:"cbook",staticStyle:{position:"relative"},style:e.eraser?"cursor: no-drop;":"",attrs:{width:e.can_width,height:e.can_height}},[n("strong",[e._v("[Your browser can not show this example.]")])])]),e.capturing?e._e():n("div",{staticClass:"settings",staticStyle:{border:"1px solid black",padding:"8px","background-color":"rgb(63 117 255)",width:"40px",height:"40px","border-radius":"50%",position:"absolute",left:"10px",bottom:"10px",display:"flex",cursor:"pointer","user-select":"none","justify-content":"center","align-items":"center"},style:"background-color:"+e.strokeStyle,on:{click:function(t){e.settingVisible=!e.settingVisible}}},[n("img",{attrs:{src:"img/icon/draw.svg",at:""}})]),!e.capturing&&e.settingVisible?n("div",{staticClass:"controls",staticStyle:{position:"absolute",left:"70px",bottom:"0px",display:"flex","flex-direction":"column","justify-content":"center","align-items":"center"}},[n("div",{staticClass:"tips",staticStyle:{width:"100%",display:"flex","flex-direction":"row-reverse","justify-content":"space-between"}},[n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.strokeStyle,expression:"strokeStyle"}],staticStyle:{"min-width":"5px","min-height":"5px",padding:"0","border-radius":"50%",overflow:"hidden",border:"1px solid black","margin-right":"5px"},style:{width:e.lineWidth+"px",height:e.lineWidth+"px"},attrs:{type:"color",disabled:e.eraser},domProps:{value:e.strokeStyle},on:{input:function(t){t.target.composing||(e.strokeStyle=t.target.value)}}})]),n("div",{staticClass:"eraser",staticStyle:{display:"flex"},on:{click:function(t){e.eraser=!e.eraser}}},[n("div",{staticClass:"button clickable btn-raised",class:{active:e.eraser},staticStyle:{transition:"0s","margin-top":"auto",width:"30px",height:"30px"}},[n("img",{attrs:{src:"img/icon/eraser.svg"}})])])]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.rangeVal,expression:"rangeVal"}],staticStyle:{"min-width":"200px",width:"25vw",height:"5vw"},attrs:{type:"range",list:"tickmarks",min:"1",max:"50"},domProps:{value:e.rangeVal},on:{__r:function(t){e.rangeVal=t.target.value}}})]):e._e(),!e.capturing&&e.settingVisible?n("div",{staticClass:"controls",staticStyle:{position:"absolute",left:"10px",bottom:"50px",display:"flex","flex-direction":"column","justify-content":"center","align-items":"flex-start"}},[n("div",{staticClass:"button clickable btn-raised",staticStyle:{padding:"8px"},on:{click:function(t){return e.$emit("show-group")}}},[n("img",{attrs:{src:"img/icon/add-group.png",alt:""}})]),n("div",{staticClass:"button clickable btn-raised"},[n("img",{attrs:{src:"img/icon/clean.svg",alt:""},on:{click:function(t){return e.clearCanvas(!1)}}})]),n("div",{staticClass:"button clickable btn-raised",staticStyle:{padding:"8px"}},[n("img",{attrs:{src:"img/icon/save.svg",alt:""},on:{click:e.save}})]),n("div",{staticClass:"button clickable btn-raised",staticStyle:{padding:"8px"}},[n("img",{attrs:{src:"img/icon/fullscreen-"+(e.isFullscreen?"exit":"enter")+".svg"},on:{click:e.fullscreen}})])]):e._e()])},f=[],m=(n("a481"),n("75fc")),g=n("c0e9"),v=n.n(g);window.h2c=v.a;var w={data:function(){return{isFullscreen:!1,settingVisible:!1,canvas:null,context:null,cb_lastPoints:{},can_width:400,can_height:200,rangeVal:10,strokeStyle:"#005AFF",backColor:"rgb(255,255,255)",eraser:!1,capturing:!1,console:window.console}},mounted:function(){var e=this;this.canvas=this.$refs.cbook,this.context=this.canvas.getContext("2d"),this.initDrawing(),this.event.on("canvasDraw",this.drawRemoteLines),this.event.on("canvasClear",function(){return e.clearCanvas(!0)})},methods:{initDrawing:function(){this.can_height=window.screen.height,this.can_width=window.screen.width,this.context.beginPath(),this.canvas.onmousedown=this.startDraw,this.canvas.onmouseup=this.stopDraw,this.canvas.ontouchstart=this.startDraw,this.canvas.ontouchstop=this.stopDraw,this.canvas.ontouchmove=this.drawMouse},startDraw:function(e){if(e.touches)for(var t=1;t<=e.touches.length;t++){var n=this.getCoords(e.touches[t-1]);this.cb_lastPoints[e.touches[t-1].identifier]=n}else{var r=this.getCoords(e);this.cb_lastPoints[0]=r,this.canvas.onmousemove=this.drawMouse}return!1},stopDraw:function(e){e.preventDefault(),this.canvas.onmousemove=null},drawMouse:function(e){var t,n=[];if(e.touches)for(var r=1;r<=e.touches.length;r++){t=this.getCoords(e.touches[r-1]);var i=[this.cb_lastPoints[e.touches[r-1].identifier].x,this.cb_lastPoints[e.touches[r-1].identifier].y,t.x,t.y];this.cb_lastPoints[e.touches[r-1].identifier]=this.drawLine.apply(this,i),n.push(i)}else{t=this.getCoords(e);var o=[this.cb_lastPoints[0].x,this.cb_lastPoints[0].y,t.x,t.y];n.push(o),this.cb_lastPoints[0]=this.drawLine.apply(this,o)}return this.context.lineWidth=this.lineWidth,this.context.strokeStyle=this.eraser?this.backColor:this.strokeStyle.hex8||this.strokeStyle,this.context.lineCap="round",this.strokeStyle.a&&this.strokeStyle.a<1&&(this.context.globalCompositeOperation="xor"),this.context.stroke(),this.$emit("draw",{type:"drawLine",coords:n,lineCap:this.context.lineCap,strokeStyle:this.context.strokeStyle,lineWidth:this.context.lineWidth}),this.context.closePath(),this.context.beginPath(),!1},drawLine:function(e,t,n,r){return this.context.moveTo(e,t),this.context.lineTo(n,r),{x:n,y:r}},drawRemoteLines:function(e){this.context.beginPath();var t=!0,n=!1,r=void 0;try{for(var i,o=p()(e.coords);!(t=(i=o.next()).done);t=!0){var a=i.value;this.drawLine.apply(this,Object(m["a"])(a))}}catch(s){n=!0,r=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}this.context.lineWidth=e.lineWidth,this.context.strokeStyle=e.strokeStyle,this.context.lineCap=e.lineCap,this.context.stroke(),this.context.closePath()},getCoords:function(e){return e.offsetX?{x:e.offsetX,y:e.offsetY}:e.layerX?{x:e.layerX,y:e.layerY}:{x:e.pageX-this.canvas.offsetLeft,y:e.pageY-this.canvas.offsetTop}},clearCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.context.clearRect(0,0,this.canvas.width,this.canvas.height),e||this.$emit("clear")},save:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.capturing=!0,e.next=3,this.$nextTick();case 3:v()(this.$refs.container).then(function(e){var n=document.createElement("a");n.setAttribute("download","MintyPaper.png"),n.setAttribute("href",e.toDataURL("image/png").replace("image/png","image/octet-stream")),t.capturing=!1,n.click()});case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),fullscreen:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.isFullscreen?window.document.exitFullscreen():this.$refs.container.requestFullscreen(),this.isFullscreen=!this.isFullscreen;case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},computed:{lineWidth:function(){return this.rangeVal<25?this.rangeVal:this.rangeVal<40?1.5*this.rangeVal:2*this.rangeVal}},watch:{tips:{deep:!0,handler:function(){}}}},b=w,y=(n("3a61"),n("2877")),x=Object(y["a"])(b,h,f,!1,null,null,null),k=x.exports,C=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"flex-center",attrs:{id:"popup"},on:{click:function(t){return t.stopPropagation(),e.$emit("dismiss")}}},[n("div",{staticClass:"popup-modal",on:{click:function(e){e.stopPropagation()}}},[n("group")],1)])},_=[],$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"list-group"},[n("li",{staticClass:"list-group-item flex-center flex-column"},[n("div",{staticClass:"my-pimg flex-center mb-1 text-dark clickable btn-raised",class:{"p-0 bg-dark":e.$root.mypimg,"p-2":!e.$root.mypimg},staticStyle:{height:"70px",width:"70px",border:"1px solid black","border-radius":"50%",overflow:"hidden"},on:{click:function(t){return e.$refs.fileinput.click()}}},[n("img",{attrs:{src:e.$root.mypimg?e.$root.mypimg:"img/icon/default-user.svg",alt:""}})]),n("input",{ref:"fileinput",staticClass:"d-none",attrs:{type:"file",accept:"image/x-png, image/gif, image/jpeg"},on:{change:e.uploadimg}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.$root.mypname,expression:"$root.mypname"}],staticClass:"pname w-100",style:"no_name"===e.$root.mypname.slice(0,7)?"color:gray;":"",attrs:{type:"text"},domProps:{value:e.$root.mypname},on:{change:e.updateName,input:function(t){t.target.composing||e.$set(e.$root,"mypname",t.target.value)}}})]),e.$root.client&&(e.$root.group[0]||{}).answered&&!(e.$root.group[0]||{}).connection.connected?n("div",{staticClass:"offer position-relative mb-1"},[n("span",{staticClass:"btn btn-success w-100 rounded-0",on:{click:function(t){return t.stopPropagation(),e.copy(e.$root.group[0].answer,"Answer")}}},[e._v("\n      Copy Answer\n    ")])]):e._e(),n("li",{staticClass:"list-group-item list-group-item-action list-group-item-primary py-1 flex-center clickable",on:{click:e.addUser}},[e._m(0)]),e._l(e.$root.group,function(t,r){return n("li",{key:r,staticClass:"list-group-item list-group-item-action d-flex flex-column px-0 border-right-0 border-left-0"},[t.answered?n("div",{staticClass:"userinfo d-flex w-100 align-items-center clickable",on:{click:function(e){t.showdetail=!t.showdetail}}},[n("div",{staticClass:"pimg flex-center bg-secondary border-secondary overflow-hidden rounded-circle",staticStyle:{height:"40px",width:"40px"}},[n("img",{attrs:{src:t.profile.img||"img/icon/default-user.svg",alt:""}})]),n("div",{staticClass:"detail ml-2 flex-grow-1"},[n("span",[e._v(e._s(t.profile.name||"noname"))]),n("span",{staticClass:"float-right text-danger px-2 font-weight-bold",on:{click:function(n){return n.stopPropagation(),e.removeUser(t)}}},[e._v("X")])])]):n("div",{staticClass:"usrdetail"},[n("div",{staticClass:"offer position-relative mb-1"},[n("span",{staticClass:"btn btn-primary w-100 rounded-0",on:{click:function(n){return n.stopPropagation(),e.copy(t.offerLink,"Offer link")}}},[e._v("\n          copy link\n        ")])]),t.answered?e._e():n("div",{staticClass:"answer d-flex flex-column"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.answer,expression:"u.answer"}],attrs:{placeholder:"Answer"},domProps:{value:t.answer},on:{input:function(n){n.target.composing||e.$set(t,"answer",n.target.value)}}}),n("div",{staticClass:"w-100 my-2 btn btn-success flex-center rounded-0",on:{click:function(n){return e.confirmUser(t)}}},[n("span",[e._v("confirm")]),t.connecting?n("growLoader"):e._e()],1)])])])})],2)},S=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"pimg flex-center p-1 overflow-hidden border border-secondary",staticStyle:{height:"35px",width:"35px","border-radius":"50%"}},[n("img",{attrs:{src:"img/icon/add-user.svg",alt:""}})])}],O=(n("7514"),n("795b")),R=n.n(O),P={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun.2.google.com:19302"},{urls:"stun:stun.3.google.com:19302"},{urls:"stun:stun.4.google.com:19302"},{urls:"stun:stun.stunprotocol.org"}]};function j(e){return L.apply(this,arguments)}function L(){return L=Object(i["a"])(regeneratorRuntime.mark(function e(t){var n,r,o,a,s,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,o=new R.a(function(e){return n=e}),a={offer:null,answer:null,setAnswer:function(e){return a.pc.setRemoteDescription(new RTCSessionDescription(e))},pc:new RTCPeerConnection(P),connected:!1,connectionPromise:new R.a(function(e){return r=e}),channel:{dataChannel:null,on:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};e&&(a.__eventListeners[e]=t)},emit:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.connectionPromise;case 2:a.channel.dataChannel.send(u()({event:t,data:n}));case 3:case"end":return e.stop()}},e)}));function t(t,n){return e.apply(this,arguments)}return t}()},__eventListeners:{"*":function(){}}},s=function(e){try{var t=JSON.parse(e.data);if(t.candidate)return void a.pc.addIceCandidate(t.candidate).catch(console.error);a.__eventListeners[t.event]&&a.__eventListeners[t.event](t.data),a.__eventListeners["*"](t.event,t.data)}catch(n){console.error(n)}},a.pc.onicecandidate=function(e){if(e.candidate)return c?a.connectionPromise.then(function(){a.connected=!0,a.channel.dataChannel.send(u()({candidate:e.candidate.toJSON()}))}):(c=!0,n())},t){e.next=14;break}return a.channel.dataChannel=a.pc.createDataChannel("dataChannel"),a.channel.dataChannel.onopen=function(){a.channel.dataChannel.onmessage=s,r()},a.pc.createOffer().then(function(e){a.pc.setLocalDescription(e)}).catch(console.error),e.next=11,o;case 11:a.offer=a.pc.localDescription.toJSON(),e.next=18;break;case 14:return a.pc.ondatachannel=function(e){a.channel.dataChannel=e.channel,r(),a.channel.dataChannel.onmessage=s},e.next=17,a.pc.setRemoteDescription(t).then(function(){return a.pc.createAnswer()}).then(function(e){return a.pc.setLocalDescription(e)}).then(function(){return o}).then(function(){return a.pc.localDescription.toJSON()});case 17:a.answer=e.sent;case 18:return e.abrupt("return",a);case 21:return e.prev=21,e.t0=e["catch"](0),console.error(e.t0),e.abrupt("return",null);case 25:case"end":return e.stop()}},e,null,[[0,21]])})),L.apply(this,arguments)}var D=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("span",[n("span",{staticClass:"spinner-grow spinner-grow-xs ml-2",class:e.spinnerClass,attrs:{role:"status","aria-hidden":"true"}}),n("span",{staticClass:"spinner-grow spinner-grow-1 spinner-grow-xs mx-1",class:e.spinnerClass,attrs:{role:"status","aria-hidden":"true"}}),n("span",{staticClass:"spinner-grow spinner-grow-2 spinner-grow-xs",class:e.spinnerClass,attrs:{role:"status","aria-hidden":"true"}})])},U=[],I={props:{spinnerClass:{default:"",type:String}}},E=I,N=(n("88c5"),Object(y["a"])(E,D,U,!1,null,"54cbe46a",null)),V=N.exports,T={data:function(){return{shareEnabled:"share"in window.navigator}},created:function(){},components:{growLoader:V},methods:{uploadimg:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var n,r,i,o,a,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.adjustImg(t.target.files[0]);case 2:for(this.$root.mypimg=e.sent,this.$refs.fileinput.files=null,this.$refs.fileinput.value="",window.localStorage.setItem("wb-mypimg",this.$root.mypimg),n=!0,r=!1,i=void 0,e.prev=9,o=p()(this.$root.group);!(n=(a=o.next()).done);n=!0)s=a.value,s.connection.channel.emit("profile",{img:this.$root.mypimg});e.next=17;break;case 13:e.prev=13,e.t0=e["catch"](9),r=!0,i=e.t0;case 17:e.prev=17,e.prev=18,n||null==o.return||o.return();case 20:if(e.prev=20,!r){e.next=23;break}throw i;case 23:return e.finish(20);case 24:return e.finish(17);case 25:case"end":return e.stop()}},e,this,[[9,13,17,25],[18,,20,24]])}));function t(t){return e.apply(this,arguments)}return t}(),adjustImg:function(e){return new R.a(function(t){var n=new FileReader;n.onload=function(){var e=new Image;e.onload=function(){var n=document.createElement("canvas"),r=100,i=e.width,o=e.height;i>o?i>r&&(o*=r/i,i=r):o>r&&(i*=r/o,o=r),n.width=i,n.height=o,n.getContext("2d").drawImage(e,0,0,i,o);var a=n.toDataURL("image/png");t(a)},e.src=this.result},n.readAsDataURL(e)})},updateName:function(){window.localStorage.setItem("wb-mypname",this.$root.mypname);var e=!0,t=!1,n=void 0;try{for(var r,i=p()(this.$root.group);!(e=(r=i.next()).done);e=!0){var o=r.value;o.connection.channel.emit("profile",{name:this.$root.mypname})}}catch(a){t=!0,n=a}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},addUser:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,n,r,i,o=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:t=e.sent,n=this.$root.group.reduce(function(e,t){return e>t.id?e:t.id},0)+1,t.channel.on("*",function(e,t){if("profile"!=e){o.event.emit(e,t);var r=!0,i=!1,a=void 0;try{for(var s,c=p()(o.$root.group);!(r=(s=c.next()).done);r=!0){var l=s.value;l.id!=n&&l.connection.channel.emit(e,t)}}catch(u){i=!0,a=u}finally{try{r||null==c.return||c.return()}finally{if(i)throw a}}}}),t.channel.dataChannel.onclose=function(){o.$root.group=o.$root.group.filter(function(e){return 1!=e.id})},r={},t.channel.on("profile",function(e){e.name&&(r.name=e.name),e.img&&(r.img=e.img),o.$forceUpdate()}),t.channel.emit("profile",{name:this.$root.mypname,img:this.$root.mypimg}),i={connection:t,id:n,connecting:!1,answered:!1,profile:r,answer:"",showdetail:!1,offerLink:window.location.href.slice(0,window.location.href.indexOf("#"))+"#"+encodeURIComponent(u()({offer:t.offer,id:n}))},this.$root.group.push(i);case 11:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),confirmUser:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:e.prev=0,n=JSON.parse(window.decodeURIComponent(t.answer)),e.next=7;break;case 4:return e.prev=4,e.t0=e["catch"](0),e.abrupt("return",window.alert("error parsing answer"));case 7:if(r=this.$root.group.find(function(e){return e.id==n.id}),r&&!0!==r.answered){e.next=10;break}return e.abrupt("return",window.alert("wrong or duplicated answer!!!"));case 10:return t.connecting=!0,r.connection.setAnswer(n.answer),e.next=14,r.connection.connectionPromise;case 14:t.connecting=!1,r.answered=!0;case 16:case"end":return e.stop()}},e,this,[[0,4]])}));function t(t){return e.apply(this,arguments)}return t}(),removeUser:function(e){e.connection.pc.close(),this.$root.group=this.$root.group.filter(function(t){return t.id!==e.id})},share:function(e){window.navigator.share({title:"invite link to whiteboard app",url:"babakzarrinbal.github.io/whiteboard",text:e,files:null})},copy:function(e,t){if(e){var n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),alert(t+" copied to clipboard!!!")}}},watch:{"$root.group":{deep:!0,handler:function(){}}}},W=T,M=(n("c665"),Object(y["a"])(W,$,S,!1,null,"bc5cc808",null)),A=M.exports,F={components:{group:A}},J=F,X=(n("f60c"),Object(y["a"])(J,C,_,!1,null,"549ff88d",null)),Y=X.exports,q={data:function(){return{console:window.console,showpopup:!1,conn:null,server:!0}},components:{whiteboard:k,popup:Y},created:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,n,r,i,o,a=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t=window.location.hash.slice(1),window.location.hash="",!t){e.next=7;break}this.server=!1;try{t=JSON.parse(decodeURIComponent(t))}catch(s){console.error(s,decodeURIComponent(t))}e.next=8;break;case 7:return e.abrupt("return");case 8:return e.next=10,j(t.offer);case 10:n=e.sent,n.channel.on("*",function(e,t){if("profile"!=e){a.event.emit(e,t);var n=!0,r=!1,i=void 0;try{for(var o,s=p()(a.$root.group);!(n=(o=s.next()).done);n=!0){var c=o.value;1!=c.id&&c.connection.channel.emit(e,t)}}catch(l){r=!0,i=l}finally{try{n||null==s.return||s.return()}finally{if(r)throw i}}}}),r=encodeURIComponent(u()({answer:n.answer,id:t.id})),i={},n.channel.on("profile",function(e){i.name=e.name,i.img=e.img,a.$forceUpdate()}),n.channel.emit("profile",{name:this.$root.mypname,img:this.$root.mypimg}),o={connection:n,connecting:!0,id:1,answered:!0,profile:i,offerLink:window.location.href,showdetail:!0,answer:r},this.$root.group.push(o),n.connectionPromise.then(function(){n.connected=!0,o.connecting=!1,n.channel.dataChannel.onclose=function(){a.$root.group=a.$root.group.filter(function(e){return 1!=e.id})}}),this.$root.client=!0,this.showpopup=!0;case 21:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),mounted:function(){window.setTimeout(function(){var e=document.getElementById("preloader");e&&(e.style.transition=".3s",e.style.opacity=0,setTimeout(function(){return e.parentNode.removeChild(e)},300))},1e3)},methods:{clearDrawing:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=p()(this.$root.group);!(e=(r=i.next()).done);e=!0){var o=r.value;o.connection.channel.emit("canvasClear",{})}}catch(a){t=!0,n=a}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}},sendDrawing:function(e){var t=!0,n=!1,r=void 0;try{for(var i,o=p()(this.$root.group);!(t=(i=o.next()).done);t=!0){var a=i.value;a.connection.channel.emit("canvasDraw",e)}}catch(s){n=!0,r=s}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}}},watch:{"$root.group":{deep:!0,handler:function(){}}},computed:{}},B=q,z=(n("5c0b"),Object(y["a"])(B,s,c,!1,null,null,null)),H=z.exports,K=n("b6d0"),Q=n.n(K),G=(n("3b2b"),n("6b54"),n("a745")),Z=n.n(G),ee=n("d225"),te=n("b0b4"),ne=function(){function e(){Object(ee["a"])(this,e),this.callbacks={}}return Object(te["a"])(e,[{key:"on",value:function(e,t){e=Z()(e)?e:[e];var n=!0,r=!1,i=void 0;try{for(var o,a=p()(e);!(n=(o=a.next()).done);n=!0){var s=o.value;this.callbacks[s.toString()]={cb:t,type:s instanceof RegExp?RegExp:String}}}catch(c){r=!0,i=c}finally{try{n||null==a.return||a.return()}finally{if(r)throw i}}}},{key:"emit",value:function(e,t){e=Z()(e)?e:[e];var n=new Q.a,r=!0,i=!1,o=void 0;try{for(var a,s=p()(e);!(r=(a=s.next()).done);r=!0){var c=a.value;for(var l in this.callbacks){var u=this.callbacks[l],d=u.type===RegExp?new RegExp(l.slice(1,l.lastIndexOf("/")),l.slice(l.lastIndexOf("/")+1)):null;(d&&d.exec(c)||l===c)&&n.add(l)}}}catch(b){i=!0,o=b}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}var h=!0,f=!1,m=void 0;try{for(var g,v=p()(n);!(h=(g=v.next()).done);h=!0){var w=g.value;this.callbacks[w].cb(t)}}catch(b){f=!0,m=b}finally{try{h||null==v.return||v.return()}finally{if(f)throw m}}}}]),e}();n("1449"),window.serverconfig=o;var re=n("fe3c");re.attach(document.body),n("8aa8");var ie=new ne;a["a"].mixin({data:function(){return{event:ie}}}),a["a"].config.productionTip=!0,new a["a"]({data:{group:[],client:!1,mypimg:window.localStorage.getItem("wb-mypimg"),mypname:window.localStorage.getItem("wb-mypname")||"no_name"},render:function(e){return e(H)}}).$mount("#app");var oe=function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.navigator.wakeLock.request("screen");case 3:window.wakeLock=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),console.error(e.t0);case 9:case"end":return e.stop()}},e,null,[[0,6]])}));return function(){return e.apply(this,arguments)}}();oe();var ae=function(){null!==window.wakeLock&&"visible"===window.document.visibilityState&&oe()};window.document.addEventListener("visibilitychange",ae),window.document.addEventListener("fullscreenchange",ae)},"5c0b":function(e,t,n){"use strict";var r=n("5e27"),i=n.n(r);i.a},"5e27":function(e,t,n){},"87b8":function(e,t,n){},8857:function(e,t,n){},"88c5":function(e,t,n){"use strict";var r=n("8857"),i=n.n(r);i.a},"8aa8":function(e,t,n){"use strict";n.r(t);var r,i,o=n("f499"),a=n.n(o),s=(n("34ef"),n("a481"),n("14b9"),n("795b")),c=n.n(s),l=(n("cadf"),n("551c"),n("f751"),n("097d"),n("9483")),u="BJIGTwPsHQ_J1Yg_9xbUDLnrz_jTq8-nDxuU3_nXPF7-DNU645CLMBsrm73g6HefM74RSTjtLr2upgWKQ30SFLk";function d(e){for(var t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(n),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}window.serviceWorkerPromise=new c.a(function(e){return r=e}),window.subscribeUser=function(){return new c.a(function(e,t){if("granted"==window.Notification.permission)return e('localStorage.getItem("pushNotificationCredentials")');window.serviceWorkerPromise.then(function(n){n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:d(u)}).then(function(t){window.localStorage.setItem("pushNotificationCredentials",a()(t)),e(t)}).catch(t)})})},window.propforinstall=null,Object(l["a"])("".concat("/whiteboard/","service-worker.js"),{registered:r}),(window.navigator||{}).serviceWorker&&window.navigator.serviceWorker.ready.then(function(){window.addEventListener("beforeinstallprompt",function(e){e.preventDefault(),i=e,window.propforinstall=function(){i.prompt(),i.userChoice.then(function(e){"accepted"===e.outcome&&window.subscribeUser(),i=null})}})})},9180:function(e,t,n){},c665:function(e,t,n){"use strict";var r=n("13d6"),i=n.n(r);i.a},cb1b:function(e,t,n){},f60c:function(e,t,n){"use strict";var r=n("06dc"),i=n.n(r);i.a}});